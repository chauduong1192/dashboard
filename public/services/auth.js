"use strict";angular.module(window.APP.modules.main).service("auth",["$rootScope","$state",function(a,b){var c,d=function(){c=this,c.init()};return d.prototype={init:function(){a.$on("$stateChangeStart",function(b,d,e,f,g){return c.isAllowed(d.auth,!0)?void 0:(a.PROGRESSBAR&&a.PROGRESSBAR.complete(),b.preventDefault())})},isAllowed:function(c,d){if(!c)return!0;if(c.requiresLogin===!0&&!a.USER.isLoggedin())return d&&b.go("login"),!1;if(c.requiresLogin===!1&&a.USER.isLoggedin())return d&&b.go("home"),!1;if(c.allows){for(var e=!1,f=Object.keys(c.allows),g=0;g<f.length;g++){var h=f[g];if(a.USER.permissions[h]){for(var i=!1,j=0;j<c.allows[h].length;j++){var k=c.allows[h][j];if(-1===a.USER.permissions[h].indexOf(k)){i=!1;break}i=!0}e=e||i}else e=e||!1}if(!e)return d&&b.go("home"),!1}return!0}},d}]);